dataC.fossilbrush.clean <- dataC.fossilbrush %>%
filter(early_interval %in% c("Changhsingian","Griesbachian","Dienerian","Smithian","Spathian") |
late_interval %in% c("Changhsingian","Griesbachian","Dienerian","Smithian","Spathian"),
accepted_rank=="species") %>%
droplevels() %>%
select(accepted_name,early_interval,late_interval) %>% unique()
View(dataC.fossilbrush.clean)
dataC.fossilbrush.clean$early_interval <- factor(dataC.fossilbrush.clean$early_interval,
levels = c("Changhsingian", "Griesbachian", "Dienerian", "Smithian", "Spathian"))
dataC.fossilbrush.clean$late_interval <- factor(dataC.fossilbrush.clean$late_interval,
levels = c("Changhsingian", "Griesbachian", "Dienerian", "Smithian", "Spathian"))
dataC.fossilbrush.clean.early <- dataC.fossilbrush.clean %>% group_by(early_interval) %>% summarise(Nombre =n())
dataC.fossilbrush.clean.late <- dataC.fossilbrush.clean %>% group_by(late_interval) %>% summarise(Nombre =n())
n.sp.paleobioDB <- full_join(dataC.fossilbrush.clean.early,dataC.fossilbrush.clean.late, by = c("early_interval"="late_interval")) %>%
mutate(#Nombre.y = replace_na(Nombre.y,0),
n.sp.fossilbrush=Nombre.x+Nombre.y) #%>% filter(!is.na(sum))
n.sp.fossilbrush <- full_join(dataC.fossilbrush.clean.early,dataC.fossilbrush.clean.late, by = c("early_interval"="late_interval")) %>%
mutate(#Nombre.y = replace_na(Nombre.y,0),
n.sp.fossilbrush=Nombre.x+Nombre.y) #%>% filter(!is.na(sum))
n.sp.paleobioDB <- full_join(n.sp.paleobioDB.early,n.sp.paleobioDB.late, by = c("oei"="oli")) %>%
mutate(Nombre.y = replace_na(Nombre.y,0),
n.sp.paleobioDB=Nombre.x+Nombre.y) %>% filter(!is.na(sum))
dataC.paleobioDB.clean$oei <- factor(dataC.paleobioDB.clean$oei,
levels = c("Changhsingian", "Griesbachian", "Dienerian", "Smithian", "Spathian"))
dataC.paleobioDB.clean$oli <- factor(dataC.paleobioDB.clean$oli,
levels = c("NA", "Griesbachian", "Dienerian", "Smithian", "Spathian"))
n.sp.paleobioDB.early <- dataC.paleobioDB.clean %>% group_by(oei) %>% summarise(Nombre =n())
n.sp.paleobioDB.late <- dataC.paleobioDB.clean %>% group_by(oli) %>% summarise(Nombre =n())
n.sp.paleobioDB <- full_join(n.sp.paleobioDB.early,n.sp.paleobioDB.late, by = c("oei"="oli")) %>%
mutate(Nombre.y = replace_na(Nombre.y,0),
n.sp.paleobioDB=Nombre.x+Nombre.y) %>% filter(!is.na(sum))
dataC.paleobioDB.clean <- dataC.paleobioDB %>%
filter(oei %in% c("Changhsingian","Griesbachian","Dienerian","Smithian","Spathian") |
oli %in% c("Changhsingian","Griesbachian","Dienerian","Smithian","Spathian")) %>%
droplevels() %>%
select(tna,oei,oli) %>% droplevels() %>% unique()
dataC.paleobioDB.clean$oei <- factor(dataC.paleobioDB.clean$oei,
levels = c("Changhsingian", "Griesbachian", "Dienerian", "Smithian", "Spathian"))
dataC.paleobioDB.clean$oli <- factor(dataC.paleobioDB.clean$oli,
levels = c("NA", "Griesbachian", "Dienerian", "Smithian", "Spathian"))
n.sp.paleobioDB.early <- dataC.paleobioDB.clean %>% group_by(oei) %>% summarise(Nombre =n())
n.sp.paleobioDB.late <- dataC.paleobioDB.clean %>% group_by(oli) %>% summarise(Nombre =n())
n.sp.paleobioDB <- full_join(n.sp.paleobioDB.early,n.sp.paleobioDB.late, by = c("oei"="oli")) %>%
mutate(Nombre.y = replace_na(Nombre.y,0),
n.sp.paleobioDB=Nombre.x+Nombre.y) %>% filter(!is.na(sum))
n.sp.paleobioDB <- full_join(n.sp.paleobioDB.early,n.sp.paleobioDB.late, by = c("oei"="oli")) %>%
mutate(Nombre.y = replace_na(Nombre.y,0),
n.sp.paleobioDB=Nombre.x+Nombre.y) %>% filter(!is.na(n.sp.paleobioDB))
View(n.sp.paleobioDB)
View(n.sp.fossilbrush)
View(dataC.paleoDiv.clean)
dataC.paleoDiv.clean <- dataC.paleoDiv %>%
filter(early_interval %in% c("Changhsingian","Griesbachian","Dienerian","Smithian","Spathian") |
late_interval %in% c("Changhsingian","Griesbachian","Dienerian","Smithian","Spathian"),
accepted_rank=="species") %>%
droplevels() %>%
select(accepted_name,early_interval,late_interval) %>% unique()
dataC.paleoDiv.clean$early_interval <- factor(dataC.paleoDiv.clean$early_interval,
levels = c("Changhsingian", "Griesbachian", "Dienerian", "Smithian", "Spathian"))
dataC.paleoDiv.clean$late_interval <- factor(dataC.paleoDiv.clean$late_interval,
levels = c("Changhsingian", "Griesbachian", "Dienerian", "Smithian", "Spathian"))
dataC.paleoDiv.clean.early <- dataC.paleoDiv.clean %>% group_by(early_interval) %>% summarise(Nombre =n())
dataC.paleoDiv.clean.late <- dataC.paleoDiv.clean %>% group_by(late_interval) %>% summarise(Nombre =n())
n.sp.fossilbrush <- full_join(dataC.paleoDiv.clean.early, dataC.paleoDiv.clean.late, by = c("early_interval"="late_interval")) %>%
mutate(n.sp.paleoDiv=Nombre.x+Nombre.y)
View(n.sp.paleobioDB)
n.sp.fossilbrush <- full_join(dataC.fossilbrush.clean.early,dataC.fossilbrush.clean.late, by = c("early_interval"="late_interval")) %>%
mutate(n.sp.fossilbrush=Nombre.x+Nombre.y)
n.sp.paleoDiv <- full_join(dataC.paleoDiv.clean.early, dataC.paleoDiv.clean.late, by = c("early_interval"="late_interval")) %>%
mutate(n.sp.paleoDiv=Nombre.x+Nombre.y)
View(n.sp.paleoDiv)
n.sp.paleoDiv <- full_join(dataC.paleoDiv.clean.early, dataC.paleoDiv.clean.late, by = c("early_interval"="late_interval")) %>%
mutate(Nombre.y = replace_na(Nombre.y,0),
n.sp.paleoDiv=Nombre.x+Nombre.y) %>% filter(!is.na(n.sp.paleoDiv))
View(n.sp)
n.sp <- SiB.clean %>% group_by(Sub_stage) %>% summarise(ConoDB =n())
n.sp.paleoDiv <- full_join(dataC.paleoDiv.clean.early, dataC.paleoDiv.clean.late, by = c("early_interval"="late_interval")) %>%
mutate(Nombre.y = replace_na(Nombre.y,0),
paleoDiv=Nombre.x+Nombre.y) %>% filter(!is.na(paleoDiv))
n.sp.fossilbrush <- full_join(dataC.fossilbrush.clean.early,dataC.fossilbrush.clean.late, by = c("early_interval"="late_interval")) %>%
mutate(fossilbrush=Nombre.x+Nombre.y)
n.sp.paleobioDB <- full_join(n.sp.paleobioDB.early,n.sp.paleobioDB.late, by = c("oei"="oli")) %>%
mutate(Nombre.y = replace_na(Nombre.y,0),
paleobioDB=Nombre.x+Nombre.y) %>% filter(!is.na(paleobioDB))
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,150),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp$Nombre, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp$Nombre,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush, col="darkgoldenrod", pch=16)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush,  pch = 10, col = "darkgoldenrod", lty = 1)
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,150),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp$Nombre, col="black", pch=15)
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,150),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush, col="darkgoldenrod", pch=16)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush,  pch = 10, col = "darkgoldenrod", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB, col="darkcyan", pch=17)
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,150),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush, col="darkgoldenrod", pch=16)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush,  pch = 10, col = "darkgoldenrod", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB, col="darkcyan", pch=17)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB,  pch = 10, col = "darkcyan", lty = 1)
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,150),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush, col="darkgoldenrod", pch=16)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush,  pch = 10, col = "darkgoldenrod", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB, col="darkcyan", pch=17)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB,  pch = 10, col = "darkcyan", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv, col="darkmagenta", pch=18)
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,150),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush, col="darkgoldenrod", pch=16)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush,  pch = 10, col = "darkgoldenrod", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB, col="darkcyan", pch=17)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB,  pch = 10, col = "darkcyan", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush, col="darkgoldenrod", pch=16)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush,  pch = 10, col = "darkgoldenrod", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB, col="darkcyan", pch=17)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB,  pch = 10, col = "darkcyan", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
View(dataC.fossilbrush.clean)
dataC.fossilbrush.clean %>% filter(early_interval=="Dienerian"|late_interval=="Dienerian")
Occ.NT.2022.clean.SiB <- Occ.NT.2022.clean %>%
select(Species_in_paper, Gn_Species_current, Stage, Sub_stage) %>%
unique() %>% droplevels()
Occ.NT.2022.clean.SiB$Sub_stage <- as.character(Occ.NT.2022.clean.SiB$Sub_stage)
Occ.NT.2022.clean.SiB$Sub_stage[which(Occ.NT.2022.clean.SiB$Stage=="Changhsingian")] <- "Changhsingian"
Occ.NT.2022.clean.SiB$Sub_stage <- as.factor(Occ.NT.2022.clean.SiB$Sub_stage)
SiB.clean <- Occ.NT.2022.clean.SiB %>%
filter(Sub_stage %in% c("Changhsingian", "Griesbachian", "Dienerian", "Smithian", "Spathian")) %>%
droplevels()
SiB.clean$Sub_stage <- factor(SiB.clean$Sub_stage,
levels = c("Changhsingian", "Griesbachian", "Dienerian", "Smithian", "Spathian"))
View(SiB.clean)
n.sp.orig <- SiB.clean %>%
select(!Gn_Species_current) %>% unique() %>%
group_by(Sub_stage) %>% summarise(ConoDB =n())
n.sp.curr <- SiB.clean %>%
select(!Species_in_paper) %>% unique() %>%
group_by(Sub_stage) %>% summarise(ConoDB =n())
n.sp.orig
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.orig$ConoDB, col="grey70", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.orig$ConoDB,  pch = 10, col = "grey70", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush, col="darkgoldenrod", pch=16)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush,  pch = 10, col = "darkgoldenrod", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB, col="darkcyan", pch=17)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB,  pch = 10, col = "darkcyan", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
n.sp.orig
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,150),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.orig$ConoDB, col="grey70", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.orig$ConoDB,  pch = 10, col = "grey70", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush, col="darkgoldenrod", pch=16)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush,  pch = 10, col = "darkgoldenrod", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB, col="darkcyan", pch=17)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB,  pch = 10, col = "darkcyan", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
cols <- c("black", "grey70","darkgoldenrod","darkcyan","darkmagenta")
point <- c(15,15,16,17,18)
plotnames <-c("ConoDB current", "ConoDB original", "PBDB fossil brush", "PBDB paleobioDB", "PBDB paleoDiv")
legend("topleft", inset=c(0.01, 0.01),
legend= plotnames, pch = point, bg="white")
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,150),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.orig$ConoDB, col="grey70", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.orig$ConoDB,  pch = 10, col = "grey70", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush, col="darkgoldenrod", pch=16)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush,  pch = 10, col = "darkgoldenrod", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB, col="darkcyan", pch=17)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB,  pch = 10, col = "darkcyan", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
cols <- c("black", "grey70","darkgoldenrod","darkcyan","darkmagenta")
point <- c(15,15,16,17,18)
plotnames <-c("ConoDB current", "ConoDB original", "PBDB fossil brush", "PBDB paleobioDB", "PBDB paleoDiv")
legend("topleft", inset=c(0.01, 0.01),
legend= plotnames, pch = point, bg="white")
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,150),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.orig$ConoDB, col="grey70", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.orig$ConoDB,  pch = 10, col = "grey70", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush, col="darkgoldenrod", pch=16)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush,  pch = 10, col = "darkgoldenrod", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB, col="darkcyan", pch=17)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB,  pch = 10, col = "darkcyan", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
cols <- c("black", "grey70","darkgoldenrod","darkcyan","darkmagenta")
point <- c(15,15,16,17,18)
plotnames <-c("ConoDB current", "ConoDB original", "PBDB fossil brush", "PBDB paleobioDB", "PBDB paleoDiv")
legend("topleft", inset=c(0.01, 0.01),
legend= plotnames, pch = point, bg="white", col=cols, lwd=1, lty=1)
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,200),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.orig$ConoDB, col="grey70", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.orig$ConoDB,  pch = 10, col = "grey70", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush, col="darkgoldenrod", pch=16)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush,  pch = 10, col = "darkgoldenrod", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB, col="darkcyan", pch=17)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB,  pch = 10, col = "darkcyan", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
cols <- c("black", "grey70","darkgoldenrod","darkcyan","darkmagenta")
point <- c(15,15,16,17,18)
plotnames <-c("ConoDB current", "ConoDB original", "PBDB fossil brush", "PBDB paleobioDB", "PBDB paleoDiv")
legend("topleft", inset=c(0.01, 0.01),
legend= plotnames, pch = point, bg="white", col=cols, lwd=1, lty=1)
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,250),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.orig$ConoDB, col="grey70", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.orig$ConoDB,  pch = 10, col = "grey70", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush, col="darkgoldenrod", pch=16)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush,  pch = 10, col = "darkgoldenrod", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB, col="darkcyan", pch=17)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB,  pch = 10, col = "darkcyan", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
cols <- c("black", "grey70","darkgoldenrod","darkcyan","darkmagenta")
point <- c(15,15,16,17,18)
plotnames <-c("ConoDB current", "ConoDB original", "PBDB fossil brush", "PBDB paleobioDB", "PBDB paleoDiv")
legend("topleft", inset=c(0.01, 0.01),
legend= plotnames, pch = point, bg="white", col=cols, lwd=1, lty=1)
knitr::opts_chunk$set(echo = TRUE)
# knitr::opts_knit$set(root.dir="C:/Users/33677/Documents/NEW_WORK/THESE/Permian-Triassic assembly-process/Rmarkdown outputs")
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,250),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
cols <- c("black","darkmagenta")
point <- c(15,18)
plotnames <-c("Present database", "PaleoBiology DataBase")
legend("topleft", inset=c(0.01, 0.01),
legend= plotnames, pch = point, bg="white", col=cols, lwd=1, lty=1)
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
cols <- c("black","darkmagenta")
point <- c(15,18)
plotnames <-c("Present database", "PaleoBiology DataBase")
legend("topleft", inset=c(0.01, 0.01),
legend= plotnames, pch = point, bg="white", col=cols, lwd=1, lty=1)
?tsplot
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105))
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
boxes.args = list(ybottom=10, ytop=20))#labels.args=list(cex=0.6))
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
boxes.args = list(rect(ybottom=10, ytop=20)))#labels.args=list(cex=0.6))
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
boxes.args = list(rect(xleft=1, xright= 2, ybottom=10, ytop=20)))#labels.args=list(cex=0.6))
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
boxes.args = list(rect(xleft=1, xright= 2, ybottom=10, ytop=20)))#labels.args=list(cex=0.6))
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
boxes.args = rect(xleft=1, xright= 2, ybottom=10, ytop=20)))#labels.args=list(cex=0.6))
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
boxes.args = rect(xleft=1, xright= 2, ybottom=10, ytop=20))#labels.args=list(cex=0.6))
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
boxes.args = list(rect(xleft=1, xright= 2, ybottom=10, ytop=20)))#labels.args=list(cex=0.6))
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
boxes.args = list(rect(xleft=1, xright= 2, ybottom=10, ytop=20)))#labels.args=list(cex=0.6))
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105))
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
boxes.args = list(rect(xleft=1, xright= 2, ybottom=10, ytop=20)))#labels.args=list(cex=0.6))
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
labels.args=list(cex=0.6))
setwd("C:/Users/33677/Documents/NEW_WORK/THESE/PCI/Figures")
svg(filename="Figure XXX_Div curves.svg", width = 7, height = 4)
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
cols <- c("black","darkmagenta")
point <- c(15,18)
plotnames <-c("Present database", "PaleoBiology DataBase")
legend("topleft", inset=c(0.01, 0.01),
legend= plotnames, pch = point, bg="white", col=cols, lwd=1, lty=1)
dev.off()
