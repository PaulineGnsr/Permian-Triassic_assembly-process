y=n.sp.orig$ConoDB, col="grey70", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.orig$ConoDB,  pch = 10, col = "grey70", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush, col="darkgoldenrod", pch=16)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush,  pch = 10, col = "darkgoldenrod", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB, col="darkcyan", pch=17)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB,  pch = 10, col = "darkcyan", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
cols <- c("black", "grey70","darkgoldenrod","darkcyan","darkmagenta")
point <- c(15,15,16,17,18)
plotnames <-c("ConoDB current", "ConoDB original", "PBDB fossil brush", "PBDB paleobioDB", "PBDB paleoDiv")
legend("topleft", inset=c(0.01, 0.01),
legend= plotnames, pch = point, bg="white")
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,150),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.orig$ConoDB, col="grey70", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.orig$ConoDB,  pch = 10, col = "grey70", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush, col="darkgoldenrod", pch=16)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush,  pch = 10, col = "darkgoldenrod", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB, col="darkcyan", pch=17)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB,  pch = 10, col = "darkcyan", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
cols <- c("black", "grey70","darkgoldenrod","darkcyan","darkmagenta")
point <- c(15,15,16,17,18)
plotnames <-c("ConoDB current", "ConoDB original", "PBDB fossil brush", "PBDB paleobioDB", "PBDB paleoDiv")
legend("topleft", inset=c(0.01, 0.01),
legend= plotnames, pch = point, bg="white")
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,150),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.orig$ConoDB, col="grey70", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.orig$ConoDB,  pch = 10, col = "grey70", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush, col="darkgoldenrod", pch=16)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush,  pch = 10, col = "darkgoldenrod", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB, col="darkcyan", pch=17)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB,  pch = 10, col = "darkcyan", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
cols <- c("black", "grey70","darkgoldenrod","darkcyan","darkmagenta")
point <- c(15,15,16,17,18)
plotnames <-c("ConoDB current", "ConoDB original", "PBDB fossil brush", "PBDB paleobioDB", "PBDB paleoDiv")
legend("topleft", inset=c(0.01, 0.01),
legend= plotnames, pch = point, bg="white", col=cols, lwd=1, lty=1)
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,200),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.orig$ConoDB, col="grey70", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.orig$ConoDB,  pch = 10, col = "grey70", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush, col="darkgoldenrod", pch=16)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush,  pch = 10, col = "darkgoldenrod", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB, col="darkcyan", pch=17)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB,  pch = 10, col = "darkcyan", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
cols <- c("black", "grey70","darkgoldenrod","darkcyan","darkmagenta")
point <- c(15,15,16,17,18)
plotnames <-c("ConoDB current", "ConoDB original", "PBDB fossil brush", "PBDB paleobioDB", "PBDB paleoDiv")
legend("topleft", inset=c(0.01, 0.01),
legend= plotnames, pch = point, bg="white", col=cols, lwd=1, lty=1)
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,250),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.orig$ConoDB, col="grey70", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.orig$ConoDB,  pch = 10, col = "grey70", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush, col="darkgoldenrod", pch=16)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.fossilbrush$fossilbrush,  pch = 10, col = "darkgoldenrod", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB, col="darkcyan", pch=17)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleobioDB$paleobioDB,  pch = 10, col = "darkcyan", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
cols <- c("black", "grey70","darkgoldenrod","darkcyan","darkmagenta")
point <- c(15,15,16,17,18)
plotnames <-c("ConoDB current", "ConoDB original", "PBDB fossil brush", "PBDB paleobioDB", "PBDB paleoDiv")
legend("topleft", inset=c(0.01, 0.01),
legend= plotnames, pch = point, bg="white", col=cols, lwd=1, lty=1)
knitr::opts_chunk$set(echo = TRUE)
# knitr::opts_knit$set(root.dir="C:/Users/33677/Documents/NEW_WORK/THESE/Permian-Triassic assembly-process/Rmarkdown outputs")
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,250),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
cols <- c("black","darkmagenta")
point <- c(15,18)
plotnames <-c("Present database", "PaleoBiology DataBase")
legend("topleft", inset=c(0.01, 0.01),
legend= plotnames, pch = point, bg="white", col=cols, lwd=1, lty=1)
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
cols <- c("black","darkmagenta")
point <- c(15,18)
plotnames <-c("Present database", "PaleoBiology DataBase")
legend("topleft", inset=c(0.01, 0.01),
legend= plotnames, pch = point, bg="white", col=cols, lwd=1, lty=1)
?tsplot
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105))
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
boxes.args = list(ybottom=10, ytop=20))#labels.args=list(cex=0.6))
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
boxes.args = list(rect(ybottom=10, ytop=20)))#labels.args=list(cex=0.6))
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
boxes.args = list(rect(xleft=1, xright= 2, ybottom=10, ytop=20)))#labels.args=list(cex=0.6))
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
boxes.args = list(rect(xleft=1, xright= 2, ybottom=10, ytop=20)))#labels.args=list(cex=0.6))
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
boxes.args = rect(xleft=1, xright= 2, ybottom=10, ytop=20)))#labels.args=list(cex=0.6))
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
boxes.args = rect(xleft=1, xright= 2, ybottom=10, ytop=20))#labels.args=list(cex=0.6))
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
boxes.args = list(rect(xleft=1, xright= 2, ybottom=10, ytop=20)))#labels.args=list(cex=0.6))
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
boxes.args = list(rect(xleft=1, xright= 2, ybottom=10, ytop=20)))#labels.args=list(cex=0.6))
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105))
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
boxes.args = list(rect(xleft=1, xright= 2, ybottom=10, ytop=20)))#labels.args=list(cex=0.6))
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
labels.args=list(cex=0.6))
setwd("C:/Users/33677/Documents/NEW_WORK/THESE/PCI/Figures")
svg(filename="Figure XXX_Div curves.svg", width = 7, height = 4)
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
cols <- c("black","darkmagenta")
point <- c(15,18)
plotnames <-c("Present database", "PaleoBiology DataBase")
legend("topleft", inset=c(0.01, 0.01),
legend= plotnames, pch = point, bg="white", col=cols, lwd=1, lty=1)
dev.off()
knitr::opts_chunk$set(echo = TRUE)
# knitr::opts_knit$set(root.dir="C:/Users/33677/Documents/NEW_WORK/THESE/Permian-Triassic assembly-process/Rmarkdown outputs")
library(dplyr)
library(tidyr)
library(tibble)
library(purrr)
library(ggplot2)
library(ggpubr)
library(ggrepel)
library(ggdendro)
library(viridis)
library(rgplates)
library(sp)
library(stats)
library(geosphere)
library(iNEXT)
library(ade4)
library(adespatial)
library(labdsv)
library(ape)
library(vegan)
library(emstreeR)
library(igraph)
library("metagMisc")
library(divDyn)
# devtools::install_github("Corentin-Gibert-Paleontology/DNCImper")
library(DNCImper)
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB, col="black", pch=15)
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
cols <- c("black","darkmagenta")
point <- c(15,18)
plotnames <-c("Present database", "PaleoBiology DataBase")
legend("topleft", inset=c(0.01, 0.01),
legend= plotnames, pch = point, bg="white", col=cols, lwd=1, lty=1)
data("stages")
Low.Trias <- read.csv2("Low_Trias.csv", h=T, dec=",")
stages <- rbind(stages, Low.Trias)
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,105),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
cols <- c("black","darkmagenta")
point <- c(15,18)
plotnames <-c("Present database", "PaleoBiology DataBase")
legend("topleft", inset=c(0.01, 0.01),
legend= plotnames, pch = point, bg="white", col=cols, lwd=1, lty=1)
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,120),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
cols <- c("black","darkmagenta")
point <- c(15,18)
plotnames <-c("Present database", "PaleoBiology DataBase")
legend("topleft", inset=c(0.01, 0.01),
legend= plotnames, pch = point, bg="white", col=cols, lwd=1, lty=1)
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,120),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
cols <- c("black","darkmagenta")
point <- c(15,18)
plotnames <-c("Present database", "PaleoBiology DataBase")
legend("topleft", inset=c(0.02, 0.02),
legend= plotnames, pch = point, bg="white", col=cols, lwd=1, lty=1)
legend("topleft", inset=c(0.02, 0.03),
legend= plotnames, pch = point, bg="white", col=cols, lwd=1, lty=1)
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,120),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
cols <- c("black","darkmagenta")
point <- c(15,18)
plotnames <-c("Present database", "PaleoBiology DataBase")
legend("topleft", inset=c(0.02, 0.03),
legend= plotnames, pch = point, bg="white", col=cols, lwd=1, lty=1)
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,120),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
cols <- c("black","darkmagenta")
point <- c(15,18)
plotnames <-c("Present database", "PaleoBiology DataBase")
legend("topleft", inset=c(0.02, 0.05),
legend= plotnames, pch = point, bg="white", col=cols, lwd=1, lty=1)
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,125),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
cols <- c("black","darkmagenta")
point <- c(15,18)
plotnames <-c("Present database", "PaleoBiology DataBase")
legend("topleft", inset=c(0.02, 0.04),
legend= plotnames, pch = point, bg="white", col=cols, lwd=1, lty=1)
setwd("C:/Users/33677/Documents/NEW_WORK/THESE/PCI/Figures")
svg(filename="Figure XXX_Div curves.svg", width = 7, height = 4)
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,120),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
cols <- c("black","darkmagenta")
point <- c(15,18)
plotnames <-c("Present database", "PaleoBiology DataBase")
legend("topleft", inset=c(0.02, 0.05),
legend= plotnames, pch = point, bg="white", col=cols, lwd=1, lty=1)
dev.off()
setwd("C:/Users/33677/Documents/NEW_WORK/THESE/PCI/Figures")
svg(filename="Figure XXX_Div curves.svg", width = 7, height = 4)
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,130),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
cols <- c("black","darkmagenta")
point <- c(15,18)
plotnames <-c("Present database", "PaleoBiology DataBase")
legend("topleft", inset=c(0.02, 0.05),
legend= plotnames, pch = point, bg="white", col=cols, lwd=1, lty=1)
dev.off()
data("stages")
Low.Trias <- read.csv2("Low_Trias.csv", h=T, dec=",")
stages <- rbind(stages, Low.Trias)
View(stages)
stages[which(stages$stage==Changhsingian), 'top']
stages[which(stages$stage=="Changhsingian"), 'top']
stages[which(stages$stage=="Changhsingian"), 'top'] <- 252.018
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,130),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
cols <- c("black","darkmagenta")
point <- c(15,18)
plotnames <-c("Present database", "PaleoBiology DataBase")
legend("topleft", inset=c(0.02, 0.05),
legend= plotnames, pch = point, bg="white", col=cols, lwd=1, lty=1)
setwd("C:/Users/33677/Documents/NEW_WORK/THESE/PCI/Figures")
svg(filename="Figure XXX_Div curves.svg", width = 7, height = 4)
divDyn::tsplot(stages, boxes=c("short","system"), shading= "short", boxes.col=c("col","systemCol"),
xlim=which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian")),
ylab="Sample in bin diversity",
ylim=c(0,130),
labels.args=list(cex=0.6))
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB, col="black", pch=15)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.curr$ConoDB,  pch = 10, col = "black", lty = 1)
points(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv, col="darkmagenta", pch=18)
lines(x=stages$mid[which(stages$stage %in% c("Changhsingian", "Griesbachian","Dienerian","Smithian","Spathian"))],
y=n.sp.paleoDiv$paleoDiv,  pch = 10, col = "darkmagenta", lty = 1)
cols <- c("black","darkmagenta")
point <- c(15,18)
plotnames <-c("Present database", "PaleoBiology DataBase")
legend("topleft", inset=c(0.02, 0.05),
legend= plotnames, pch = point, bg="white", col=cols, lwd=1, lty=1)
dev.off()
setwd("~/NEW_WORK/THESE/Permian-Triassic assembly-process/Rmarkdown scripts")
